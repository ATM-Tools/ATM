<!DOCTYPE html>
<html>
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'><path d='M20 4H4c-1.11 0-1.99.89-1.99 2L2 18c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V6c0-1.11-.89-2-2-2zm0 14H4v-6h16v6zm0-10H4V6h16v2z' fill='%23007bff'/><circle cx='12' cy='12' r='3' fill='%23ffffff'/></svg>">
  <title>TransSheet Organizer</title>
</head>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

<body>
  <!-- Loader element -->
  <div id="loader">
    <div class="loader"></div>
  </div>

  <!-- Login Password Form -->
  <div class="form-container" id="passwordForm">
    <center><b>ATM TOOLS</b></center><br>
    <div class="password-group" id="passwordGroup">
      <input type="password" id="passwordInput" placeholder="Enter password">
      <button class="eye-btn" onclick="togglePasswordVisibility()">
        <svg class="eye" viewBox="0 0 24 24">
          <path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/>
        </svg>
        <svg class="eye-cut" viewBox="0 0 24 24">
          <path d="M12 7c2.76 0 5 2.24 5 5 0 .65-.13 1.26-.36 1.83l2.92 2.92c1.51-1.26 2.7-2.89 3.43-4.75-1.73-4.39-6-7.5-11-7.5-1.4 0-2.74.25-3.98.7l2.16 2.16C10.74 7.13 11.35 7 12 7zM2 4.27l2.28 2.28.46.46C3.08 8.3 1.78 10.02 1 12c1.73 4.39 6 7.5 11 7.5 1.55 0 3.03-.3 4.38-.84l.42.42L19.73 22 21 20.73 3.27 3 2 4.27zM7.53 9.8l1.55 1.55c-.05.21-.08.43-.08.65 0 1.66 1.34 3 3 3 .22 0 .44-.03.65-.08l1.55 1.55c-.67.33-1.41.53-2.2.53-2.76 0-5-2.24-5-5 0-.79.2-1.53.53-2.2zm4.31-.78l3.15 3.15.02-.16c0-1.66-1.34-3-3-3l-.17.01z"/>
        </svg>
      </button>
    </div>
    <button class="submit-button" id="submitButton" onclick="checkPassword(); redirectToPage();">Submit</button>
    <p id="errorMessage"></p>
    <p id="waitMessage"></p>
  </div>

  <!-- Page common contents (Welcoming message) -->
  <div class="commonContent content">


    <!-- Header and Navbar -->
    <div class="header-table">
      <table width="100%" border="0">
        <tr>
          <td align="left"><b>TransSheet Organizer</b></td>
          <td align="right" width="10px">
            <button style="background-color: #ff4444; color: white; border: none; padding: 9px 10px; cursor: pointer;" onclick="logout()">Logout</button>
          </td>
          <td width="20px" align="right">
            <button class="openbtn" onclick="toggleNav()">
              <div class="container" id="menuIcon">
                <div class="bar1"></div>
                <div class="bar2"></div>
                <div class="bar3"></div>
              </div>
            </button>
          </td>
        </tr>
      </table>
    </div>

    <!-- Top Navigation Panel Start -->
    <div id="myTopPanel" class="toppanel">
      <canvas id="progress-bar"></canvas>

      <!-- Navigation Links -->
      <!-- Home -->
      <a href="./../../../index.html">
        <table border="0" style="padding:0; margin:0;">
          <tr>
            <td>
              <svg viewBox="0 0 24 24" width="20" height="20">
                <path d="M12 2L2 10h2v10h6v-6h4v6h6V10h2L12 2z" fill="white"/>
              </svg>
            </td>
            <td>Home</td>
          </tr>
        </table>
      </a>

      <!-- Services -->
      <a href="javascript:void(0)" onclick="toggleSubmenu('Services')">
        <table border="0" style="padding:0; margin:0;">
          <tr>
            <td>
              <svg viewBox="0 0 24 24" width="20" height="20" fill="white" xmlns="http://www.w3.org/2000/svg">
                <path d="M9.4 16.6L4.8 12L9.4 7.4L8 6L2 12L8 18L9.4 16.6ZM14.6 16.6L19.2 12L14.6 7.4L16 6L22 12L16 18L14.6 16.6Z"/>
              </svg>
            </td>
            <td>Services</td>
          </tr>
        </table>
      </a>

      <!-- Submenu for Services -->
            <div id="Services" class="submenu">
                <a href="./../../../SidePages/0-Services/0-SecurityData/SecurityData.html">Security Data</a>
                <a href="./../../../SidePages/0-Services/1-ErrorCodes/ErrorCodes.html">Error Codes</a>
                <a href="./../../../SidePages/0-Services/2-Parts/Parts.html">Parts</a>
                <div class="adminContent content"><a href="./../../../SidePages/0-Services/3-DataGenerator/DataGenerator.html">Data Generator</a></div>
                <a href="./../../../SidePages/0-Services/4-E-mailAssistant/EmailFormAssistant.html">E-mail Assistant</a>
                <a href="./../../../SidePages/0-Services/5-OCR/OCR.html">OCR</a>
                <a href="./../../../SidePages/0-Services/6-ActivitySheet/ActivitySheet.html">TransSheet Organizer</a>                
				<a href="./../../../SidePages/0-Services/7-TaskList/TaskList.html">Task List</a>
            </div>

      <!-- Guides -->
      <a href="javascript:void(0)" onclick="toggleSubmenu('Guides')">
        <table border="0" style="padding:0; margin:0;">
          <tr>
            <td>
              <svg viewBox="0 0 24 24" width="20" height="20" fill="white" xmlns="http://www.w3.org/2000/svg">
                <path d="M14 2H6C4.9 2 4 2.9 4 4V20C4 21.1 4.9 22 6 22H18C19.1 22 20 21.1 20 20V8L14 2ZM18 20H6V4H13V9H18V20ZM8 12H10V18H8V12ZM12 12H14V18H12V12ZM16 12H18V18H16V12Z"/>
              </svg>
            </td>
            <td>Guides</td>
          </tr>
        </table>
      </a>

      <!-- Submenu for Guides -->
           <div id="Guides" class="submenu">
                <a href="./../../../Side-Pages/1-Guides/0-InstallationGuide/InstallationGuide.html">Installation Guide</a>
                <a href="./../../../Side-Pages/1-Guides/1-MaintenanceGuide/MaintenanceGuide.html">Maintenance Guide</a>
            </div>

      <!-- Gallery -->
      <a href="javascript:void(0)" onclick="toggleSubmenu('Gallery')">
        <table border="0" style="padding:0; margin:0;">
          <tr>
            <td>
              <svg viewBox="0 0 24 24" width="20" height="20" fill="white" xmlns="http://www.w3.org/2000/svg">
                <path d="M22 16V4C22 2.9 21.1 2 20 2H8C6.9 2 6 2.9 6 4V16C6 17.1 6.9 18 8 18H20C21.1 18 22 17.1 22 16ZM11 12L13.03 14.71L16 11L20 16H8L11 12ZM2 6V20C2 21.1 2.9 22 4 22H18V20H4V6H2Z"/>
              </svg>
            </td>
            <td>Gallery</td>
          </tr>
        </table>
      </a>

      <!-- Submenu for Gallery -->
            <div id="Gallery" class="submenu">
                <a href="./../../../Side-Pages/2-Gallery/0-Videos/Videos.html">Videos</a>
                <a href="./../../../Side-Pages/2-Gallery/1-PDFs/PDFs.html">PDFs</a>
                <a href="./../../../Side-Pages/2-Gallery/2-Files/Files.html">Files</a>
                <a href="./../../../Side-Pages/2-Gallery/3-Images/Images.html">Images</a>
                <a href="./../../../Side-Pages/2-Gallery/4-RegistryTips/RegistryTips.html">Registry Tips</a>
            </div>

      <!-- About -->
        <a href="./../../../Side-Pages/3-About/About.html">
        <table border="0" style="padding:0; margin:0;">
          <tr>
            <td>
              <svg viewBox="0 0 24 24" width="20" height="20" fill="white" xmlns="http://www.w3.org/2000/svg">
                <path d="M12 2C6.48 2 2 6.48 2 12C2 17.52 6.48 22 12 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 12 2ZM13 17H11V11H13V17ZM13 9H11V7H13V9Z"/>
              </svg>
            </td>
            <td>About</td>
          </tr>
        </table>
      </a>
    </div>
    <!-- Top Navigation Panel End -->

    <!-- Common content -->
        <!-- Custom upload button -->
<!-- Custom upload button -->
<div align="center">
    <table border="0" style="margin-top:60px;">
        <tr>
            <td>
                <label for="activity-file-input" id="activity-upload-button" class="activity-upload-button">Upload File</label>
                <input type="file" id="activity-file-input" accept=".xlsx, .xls" hidden>
            </td>
            <td>
                <button id="activity-download-button" onclick="activityDownloadTableAsExcel()">Download as Excel</button>
            </td>
        </tr>
    </table>
</div>

<!-- Scrollable table container -->
<!-- Scrollable table container -->
<div class="table-container">
    <div class="table-wrapper">
        <table id="activity-table">
            <thead>
                <tr>
                    <th class="activity-th">Date</th>
                    <th class="activity-th">Site Name</th>
                    <th class="activity-th">Ticket no</th>
                    <th class="activity-th">Ticket type</th>
                    <th class="activity-th">Last update</th>
                </tr>
            </thead>
            <tbody>
                <!-- Table rows will be dynamically added here -->
            </tbody>
        </table>
    </div>
</div>

    <!-- Footer Section (page end) -->
    <footer id="footer">&copy; 2024. All Rights Reserved.</footer>
  </div>
<script>
// Add this script to your existing JavaScript
document.addEventListener('DOMContentLoaded', function () {
    const tableWrapper = document.querySelector('.table-wrapper');
    let isDown = false;
    let startX;
    let scrollLeft;

    // Mouse events for desktop
    tableWrapper.addEventListener('mousedown', (e) => {
        isDown = true;
        startX = e.pageX - tableWrapper.offsetLeft;
        scrollLeft = tableWrapper.scrollLeft;
    });

    tableWrapper.addEventListener('mouseleave', () => {
        isDown = false;
    });

    tableWrapper.addEventListener('mouseup', () => {
        isDown = false;
    });

    tableWrapper.addEventListener('mousemove', (e) => {
        if (!isDown) return;
        e.preventDefault();
        const x = e.pageX - tableWrapper.offsetLeft;
        const walk = (x - startX) * 2; // Adjust the multiplier for faster/slower scrolling
        tableWrapper.scrollLeft = scrollLeft - walk;
    });

    // Touch events for mobile
    tableWrapper.addEventListener('touchstart', (e) => {
        isDown = true;
        startX = e.touches[0].pageX - tableWrapper.offsetLeft;
        scrollLeft = tableWrapper.scrollLeft;
    });

    tableWrapper.addEventListener('touchend', () => {
        isDown = false;
    });

    tableWrapper.addEventListener('touchmove', (e) => {
        if (!isDown) return;
        e.preventDefault();
        const x = e.touches[0].pageX - tableWrapper.offsetLeft;
        const walk = (x - startX) * 2; // Adjust the multiplier for faster/slower scrolling
        tableWrapper.scrollLeft = scrollLeft - walk;
    });
});
// Add this script to your existing JavaScript
document.addEventListener('DOMContentLoaded', function () {
    const tableWrapper = document.querySelector('.table-wrapper');
    let isDown = false;
    let startX;
    let scrollLeft;

    // Mouse events for desktop
    tableWrapper.addEventListener('mousedown', (e) => {
        isDown = true;
        startX = e.pageX - tableWrapper.offsetLeft;
        scrollLeft = tableWrapper.scrollLeft;
    });

    tableWrapper.addEventListener('mouseleave', () => {
        isDown = false;
    });

    tableWrapper.addEventListener('mouseup', () => {
        isDown = false;
    });

    tableWrapper.addEventListener('mousemove', (e) => {
        if (!isDown) return;
        e.preventDefault();
        const x = e.pageX - tableWrapper.offsetLeft;
        const walk = (x - startX) * 2; // Adjust the multiplier for faster/slower scrolling
        tableWrapper.scrollLeft = scrollLeft - walk;
    });

    // Touch events for mobile
    tableWrapper.addEventListener('touchstart', (e) => {
        isDown = true;
        startX = e.touches[0].pageX - tableWrapper.offsetLeft;
        scrollLeft = tableWrapper.scrollLeft;
    });

    tableWrapper.addEventListener('touchend', () => {
        isDown = false;
    });

    tableWrapper.addEventListener('touchmove', (e) => {
        if (!isDown) return;
        e.preventDefault();
        const x = e.touches[0].pageX - tableWrapper.offsetLeft;
        const walk = (x - startX) * 2; // Adjust the multiplier for faster/slower scrolling
        tableWrapper.scrollLeft = scrollLeft - walk;
    });
});
        // Event listener for file input
        document.getElementById('activity-file-input').addEventListener('change', function(event) {
            const activityFile = event.target.files[0];
            const activityUploadButton = document.getElementById('activity-upload-button');

            if (!activityFile) {
                alert('Please select a file.');
                return;
            }

            // Update button text and style when a file is selected
            activityUploadButton.textContent = 'Uploaded';
            activityUploadButton.classList.add('chosen');

            const activityReader = new FileReader();

            activityReader.onload = function(e) {
                const activityData = new Uint8Array(e.target.result);
                const activityWorkbook = XLSX.read(activityData, { type: 'array' });

                const activitySheetName = activityWorkbook.SheetNames[0]; // Get the first sheet
                const activitySheet = activityWorkbook.Sheets[activitySheetName];
                const activityJsonData = XLSX.utils.sheet_to_json(activitySheet, { header: 1 }); // Convert to a 2D array

                const activityGroupedData = activityGroupByDate(activityJsonData);

                const activityTableBody = document.querySelector('#activity-table tbody');
                activityTableBody.innerHTML = ''; // Clear any existing data

                // Sort the dates in ascending order
                const activitySortedDates = Object.keys(activityGroupedData).sort((a, b) => new Date(a) - new Date(b));

                // Create rows from grouped data
                activitySortedDates.forEach(activityDate => {
                    const activityTableRow = document.createElement('tr');

                    // Add the date cell on the left for all rows with the same date
                    const activityDateCell = document.createElement('td');
                    activityDateCell.textContent = activityFormatDate(activityDate); // Format the date as "Sat 12/23/2024"
                    activityTableRow.appendChild(activityDateCell);

                    // Create a cell for each grouped entry on the same date
                    activityGroupedData[activityDate].forEach(activityRow => {
                        const activityColumn2 = document.createElement('td');
                        const activityColumn3 = document.createElement('td');
                        const activityColumn4 = document.createElement('td');
                        const activityLastUpdateColumn = document.createElement('td');

                        activityColumn2.textContent = activityRow[4] || ''; // Site Name
                        activityColumn2.classList.add('activity-site-name'); // Make Site Name bold
                        activityColumn3.textContent = activityRow[0] || ''; // Ticket No

                        // Modify Ticket Type to only show the word before '-'
                        if (activityRow[10]) {
                            const activityTicketType = activityRow[10].split('-')[0].trim(); // Get the word before the '-'
                            activityColumn4.textContent = activityTicketType;
                        } else {
                            activityColumn4.textContent = ''; // Fallback if no ticket type
                        }

                        // Format column 5 data as time only (hh:mm format)
                        if (activityRow[25]) {
                            let activityDate;
                            if (typeof activityRow[25] === 'number') {
                                // Handle Excel serial date
                                activityDate = XLSX.SSF.parse_date_code(activityRow[25]);
                                activityLastUpdateColumn.textContent = activityFormatTime(activityDate.H, activityDate.M);
                            } else if (!isNaN(Date.parse(activityRow[25]))) {
                                // Handle ISO or other date formats
                                activityDate = new Date(activityRow[25]);
                                activityLastUpdateColumn.textContent = activityFormatTime(activityDate.getHours(), activityDate.getMinutes());
                            } else {
                                activityLastUpdateColumn.textContent = activityRow[25]; // Fallback to raw value
                            }
                        } else {
                            activityLastUpdateColumn.textContent = '';
                        }

                        activityTableRow.appendChild(activityColumn2);
                        activityTableRow.appendChild(activityColumn3);
                        activityTableRow.appendChild(activityColumn4);
                        activityTableRow.appendChild(activityLastUpdateColumn);
                    });

                    activityTableBody.appendChild(activityTableRow);
                });

                activityApplyRowColors(); // Apply colors after populating the table
                activitySortTable(); // Sort the rows based on last update
            };

            activityReader.readAsArrayBuffer(activityFile);
        });

        // Group rows by the date in the 'Last update' column
        function activityGroupByDate(activityData) {
            const activityGrouped = {};

            activityData.forEach(activityRow => {
                if (activityRow[25]) {
                    let activityDate;
                    if (typeof activityRow[25] === 'number') {
                        // Handle Excel serial date
                        activityDate = XLSX.SSF.parse_date_code(activityRow[25]);
                        activityDate = new Date(activityDate.y, activityDate.m - 1, activityDate.d).toDateString(); // Only consider date, ignoring time
                    } else if (!isNaN(Date.parse(activityRow[25]))) {
                        // Handle ISO or other date formats
                        activityDate = new Date(activityRow[25]).toDateString();
                    }

                    if (activityDate) {
                        if (!activityGrouped[activityDate]) {
                            activityGrouped[activityDate] = [];
                        }
                        activityGrouped[activityDate].push(activityRow);
                    }
                }
            });

            return activityGrouped;
        }

        // Format time as hh:mm
        function activityFormatTime(activityHours, activityMinutes) {
            const activityHH = activityHours < 10 ? '0' + activityHours : activityHours;
            const activityMM = activityMinutes < 10 ? '0' + activityMinutes : activityMinutes;
            return `${activityHH}:${activityMM}`;
        }

        // Format date as "Sat 12/23/2024"
        function activityFormatDate(activityDateString) {
            const activityDate = new Date(activityDateString);
            const activityOptions = { weekday: 'short', month: '2-digit', day: '2-digit', year: 'numeric' };
            return activityDate.toLocaleDateString('en-US', activityOptions);
        }

        // Apply unique colors to rows with the same date (ignoring time)
        function activityApplyRowColors() {
            const activityTableBody = document.querySelector('#activity-table tbody');
            const activityRows = Array.from(activityTableBody.querySelectorAll('tr'));
            const activityDateColorMap = new Map();
            let activityColorIndex = 0;

            // Define a set of colors
            const activityColors = ['#FFC0CB', '#ADD8E6', '#98FB98', '#FFD700', '#DDA0DD'];

            activityRows.forEach(activityRow => {
                const activityDateValue = activityRow.cells[0].textContent; // 'Date' column (index 0)

                // Get the weekday (e.g., 'Sat', 'Fri')
                const activityDateObject = new Date(activityDateValue);
                const activityWeekday = activityDateObject.toLocaleString('en-US', { weekday: 'short' });

                let activityRowColor;
                
                // Set color to red for Friday and Saturday
                if (activityWeekday === 'Fri' || activityWeekday === 'Sat') {
                    activityRowColor = 'red';
                } else {
                    // For other days, apply different colors
                    if (!activityDateColorMap.has(activityDateValue)) {
                        activityRowColor = activityColors[activityColorIndex % activityColors.length];
                        activityDateColorMap.set(activityDateValue, activityRowColor);
                        activityColorIndex++;
                    } else {
                        activityRowColor = activityDateColorMap.get(activityDateValue);
                    }
                }

                activityRow.style.backgroundColor = activityRowColor;
            });
        }

        // Function to sort rows by the Last Update column (5th column)
        function activitySortTable() {
            const activityTableBody = document.querySelector('#activity-table tbody');
            const activityRows = Array.from(activityTableBody.querySelectorAll('tr'));

            activityRows.sort((activityRowA, activityRowB) => {
                const activityDateA = parseInt(activityRowA.cells[4].getAttribute('data-value'), 10);
                const activityDateB = parseInt(activityRowB.cells[4].getAttribute('data-value'), 10);

                return activityDateA - activityDateB; // Sort in ascending order (oldest to newest)
            });

            // Append sorted rows back to the table body
            activityRows.forEach(activityRow => activityTableBody.appendChild(activityRow));
        }

        // Function to download the table as an Excel file
        function activityDownloadTableAsExcel() {
            const activityTable = document.getElementById('activity-table');
            const activityWb = XLSX.utils.table_to_book(activityTable, { sheet: "Sheet1" });
            XLSX.writeFile(activityWb, 'ActivityTableData.xlsx');
        }
    </script>
  <script>
    /* Styles */
    const styles = `/*style start practs*/
    /*all styles in one line*/
    * { margin: 0; padding: 0; } 
	body { font-family: 'Poppins', sans-serif; background: #f4f4f9; color: #333; min-height: 30vh; display: flex; flex-direction: column; justify-content: center;} 
    .header-table { height: 40px; width: 100%; position: fixed; z-index: 1; top: 0; left: 0; background-color: #111; color: #fff; } 
    .bar1, .bar2, .bar3 { width: 20px; height: 1px; background-color: white; margin: 6px 0; transition: 0.4s; } 
    .change .bar1 { transform: translate(0, 7px) rotate(-45deg); } 
    .change .bar2 { opacity: 0; } 
    .change .bar3 { transform: translate(0, -7px) rotate(45deg); } 
    .toppanel { height: 0; width: 100%; position: fixed; z-index: 1; top: 40px; left: 0; background-color: #111; overflow: hidden; transition: height 0.3s ease; } 
    .toppanel a { border-bottom: 1px solid #222; padding: 10px 15px; text-decoration: none; font-size: 16px; color: #818181; display: block; text-align: left; transition: color 0.5s ease; } 
    .toppanel a:hover { background-color: #444; color: #f1f1f1; } 
    .toppanel a.visited { background-color: #444; color: #fff; } 
    .container { display: inline-block; cursor: pointer; } 
    .openbtn { font-size: 0px; cursor: pointer; background-color: #111; color: white; padding: 5px 10px; border: none; } 
    .openbtn:hover { background-color: #444; } 
    .submenu { max-height: 0; background-color: #333; margin-left: 0px; padding-left: 10px; overflow: hidden; transition: max-height 0.3s ease-out; } 
    .submenu a { font-size: 16px; } 
    footer { height: 15px; padding: 2px; margin: 0px; position: fixed; bottom: 0; left: 0; width: 100%; background-color: #111; color: #888; text-align: center; border-top: 1px solid #ddd; font-size: 14px; } 
    .content { display: none; } 
    .adminContent {} 
    .userContent {} 
    .commonContent {} 
    .form-container { background: #fff; padding: 20px; border-radius: 8px; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); display: inline-block; width: 80%; max-width: 400px; margin: 0 auto; } 
    .password-group { position: relative; display: flex; align-items: center; gap: 10px; border: 1px solid #ccc; border-radius: 8px; padding: 10px; } 
    .password-group input { flex: 1; padding: 10px; border: none; border-radius: 4px; font-size: 16px; height: 15px; font-weight: bold; } 
    .password-group button { background: transparent; border: none; cursor: pointer; padding: 0; display: flex; align-items: center; justify-content: center; height: 30px; width: 30px; } 
    .password-group button svg { width: 30px; height: 30px; fill: #333; } 
    .password-group button .eye { display: block; } 
    .password-group button .eye-cut { display: none; } 
    .password-group button.active .eye { display: none; } 
    .password-group button.active .eye-cut { display: block; } 
    .submit-button, .logout-button { margin-top: 20px; border: none; border-radius: 8px; padding: 15px 20px; font-size: 16px; cursor: pointer; width: 100%; } 
    .submit-button { background-color: #007bff; color: white; } 
    .submit-button:hover { background-color: #0056b3; } 
    #errorMessage, #waitMessage { color: red; display: none; margin-top: 10px; } 
    .titletext { font-weight: bold; font-family: monospace; display: inline-grid; font-size: 20px; } 
    .titletext:before, .titletext:after { content: "ATM Tools"; grid-area: 1/1; -webkit-mask-size: 1.5ch 100%, 100% 100%; -webkit-mask-repeat: no-repeat; -webkit-mask-composite: xor; mask-composite: exclude; animation: l36-1 1s infinite; } 
    .titletext:before { -webkit-mask-image: linear-gradient(#000 0 0), linear-gradient(#000 0 0); } 
    .titletext:after { -webkit-mask-image: linear-gradient(#000 0 0); animation: l36-1 1s infinite, l36-2 .2s infinite cubic-bezier(0.5, 200, 0.5, -200); } 
    @keyframes l36-1 { 0% { -webkit-mask-position: 0 0, 0 0; } 20% { -webkit-mask-position: .5ch 0, 0 0; } 40% { -webkit-mask-position: 100% 0, 0 0; } 60% { -webkit-mask-position: 4.5ch 0, 0 0; } 80% { -webkit-mask-position: 6.5ch 0, 0 0; } 100% { -webkit-mask-position: 2.5ch 0, 0 0; } } 
    @keyframes l36-2 { 100% { transform: translateY(0.2px); } } 
    #loader { position: fixed; inset: 0; background: #000000; display: flex; justify-content: center; align-items: center; z-index: 9999; animation: fadeOut 1s ease forwards; } 
    .loader { width: 60px; height: 60px; display: grid; } 
    .loader:before, .loader:after { content: ""; grid-area: 1/1; background: #232b2b; clip-path: polygon(0 0, 100% 0, 100% 100%, 75% 25%, 0 0, 0 100%, 100% 100%, 25% 75%, 0 0); animation: l20 1.5s infinite linear; } 
    .loader:after { clip-path: polygon(0 0, 76% 24%, 100% 100%, 24% 76%); --s: 0; } 
    @keyframes l20 { 0% { transform: perspective(100px) rotate3d(1, var(--s, 1), 0, 0); } 25% { transform: perspective(100px) rotate3d(1, var(--s, 1), 0, -90deg); } 25.01% { transform: perspective(100px) rotate3d(1, var(--s, 1), 0, -90deg); } 40%, 60% { transform: perspective(100px) rotate3d(1, var(--s, 1), 0, -180deg); } 75% { transform: perspective(100px) rotate3d(1, var(--s, 1), 0, -270deg); } 75.01% { transform: perspective(100px) rotate3d(1, var(--s, 1), 0, -270deg); } 90%, 100% { transform: perspective(100px) rotate3d(1, var(--s, 1), 0, -360deg); } } 
    @keyframes fadeOut { 0% { opacity: 1; visibility: visible; } 100% { opacity: 0; visibility: hidden; } }
    /* Style for the welcome message */
    .welcome { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background-color: rgba(0, 128, 0, 0.9); /* Green background with transparency */ color: white; padding: 20px; border-radius: 10px; font-size: 1.5em; text-align: center; opacity: 1; transition: opacity 1s ease-in-out; z-index: 1000; /* High z-index to ensure it's on top */ }
    /* Hide the welcome message initially */
    .welcome.hidden { opacity: 0; pointer-events: none; /* Ensure it doesn't block clicks */ }
    /* Progress bar */
    #progress-bar { position: fixed; /* Sticks the canvas to the viewport */ top: 0; left: 0; width: 100%; /* Full width of the viewport */ height: 3px; /* Progress bar height */ background-color: #000; /* Background color of the bar */ }
  /*ActivitySheet/ActivitySheet*/
         /* Table styles */
        .activity-table {
            border-collapse: collapse;
        }

        .activity-table, .activity-th, .activity-td {
            border: 1px solid black;
        }

        .activity-th, .activity-td {
            padding: 10px;
            text-align: left;
        }

        .activity-th {
            background-color: #f2f2f2;
            cursor: pointer;
        }

        /* Download button styles */
        #activity-download-button {
            display: block;
            padding: 10px;
            background-color: #007bff;
            color: white;
            border: none;
            cursor: pointer;
        }

        #activity-download-button:hover {
            background-color: #45a049;
        }

        /* Style for Site Name column (Column 2) */
        .activity-site-name {
            font-weight: bold;
        }

        /* Custom upload button styles */
        .activity-upload-button {
            display: block;
            padding: 8px;
            background-color: #007bff;
            color: white;
            border: none;
            cursor: pointer;
        }

        .activity-upload-button:hover {
            background-color: #0056b3;
        }

        /* Style for when a file is selected */
        .activity-upload-button.chosen {
            background-color: #28a745; /* Green background */
        }

        .activity-upload-button.chosen::after {
            content: " ✔"; /* Add a checkmark symbol */
        }
		/* Add these styles to your existing CSS */
.table-container {
    width: 100%;
    max-height: 400px; /* Set a maximum height for the container */
    overflow-x: auto; /* Enable horizontal scrolling */
    overflow-y: auto; /* Enable vertical scrolling */
    position: relative;
    border: 1px solid #ddd;
    border-radius: 8px;
    background-color: #fff;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    margin-top: 20px; /* Adjust as needed */
}

.table-wrapper {
    overflow-x: auto; /* Enable horizontal scrolling */
    white-space: nowrap; /* Prevent wrapping of table cells */
}

#activity-table {
    width: 100%;
    border-collapse: collapse;
    margin: 0 auto;
}

#activity-table th,
#activity-table td {
    padding: 12px;
    text-align: left;
    border: 1px solid #ddd;
    min-width: 150px; /* Adjust as needed */
    white-space: nowrap; /* Prevent text wrapping */
}

#activity-table th {
    background-color: #f2f2f2;
    font-weight: bold;
}

#activity-table tr:nth-child(even) {
    background-color: #f9f9f9;
}

#activity-table tr:hover {
    background-color: #f1f1f1;
}
	/*style end practs*/`;

    /* Apply styles dynamically */
    const styleSheet = document.createElement("style");
    styleSheet.type = "text/css";
    styleSheet.innerText = styles;
    document.head.appendChild(styleSheet);

    /* Toggle the visibility of the top navigation panel */
    function toggleNav() {
      const e = document.getElementById("myTopPanel"),
        t = document.getElementById("menuIcon"),
        n = e.style.height === "0px" || e.style.height === "";
      if (!n) {
        e.querySelectorAll(".submenu").forEach(e => e.style.maxHeight = null),
        e.querySelectorAll(".toppanel a").forEach(e => e.classList.remove("visited"));
      }
      e.style.height = n ? e.scrollHeight + "px" : "0",
      t.classList.toggle("change", n);
    }

    function toggleSubmenu(e) {
      const t = document.getElementById(e),
        n = document.getElementById("myTopPanel");
      t.style.maxHeight ? t.style.maxHeight = null : t.style.maxHeight = t.scrollHeight + "px",
      n.style.height = `${n.scrollHeight + (t.style.maxHeight ? t.scrollHeight : -t.scrollHeight)}px`;
    }

    /* Protected-content password code */
    const userPassword = "user123",
      adminPassword = "admin123";
    let isLocked = !1,
      countdownInterval,
      failedAttempts = parseInt(localStorage.getItem('failedAttempts')) || 0;

    function checkPassword() {
      if (!isLocked) {
        const e = document.getElementById('passwordInput').value;
        document.querySelectorAll('.content').forEach(e => e.style.display = 'none'),
        e === userPassword || e === adminPassword ? (
          failedAttempts = 0,
          localStorage.removeItem('failedAttempts'),
          document.getElementById('errorMessage').style.display = 'none',
          localStorage.setItem('userRole', e === userPassword ? 'user' : 'admin'),
          document.querySelectorAll('.commonContent').forEach(e => e.style.display = 'block'),
          e === userPassword ? document.querySelectorAll('.userContent').forEach(e => e.style.display = 'block') : document.querySelectorAll('.adminContent').forEach(e => e.style.display = 'block'),
          document.getElementById('passwordForm').style.display = 'none',
          showWelcomeMessage()
        ) : (
          failedAttempts++,
          localStorage.setItem('failedAttempts', failedAttempts),
          document.getElementById('errorMessage').textContent = `Incorrect password. ${3 - failedAttempts} attempts remaining.`,
          document.getElementById('errorMessage').style.display = 'block',
          failedAttempts >= 3 && lockForm()
        );
      }
    }

    function lockForm() {
      isLocked = !0,
      document.getElementById('passwordGroup').style.display = 'none',
      document.getElementById('submitButton').style.display = 'none',
      document.getElementById('errorMessage').style.display = 'none';
      const e = Date.now();
      localStorage.setItem('lockState', JSON.stringify({ isLocked: !0, lockTimestamp: e })),
      startCountdown(e);
    }

    function startCountdown(e) {
      const t = document.getElementById('waitMessage');
      t.style.display = 'block',
      countdownInterval = setInterval(() => {
        const n = Math.max(0, 3e4 - (Date.now() - e));
        t.textContent = `Try again after ${Math.ceil(n / 1e3)} seconds.`,
        n <= 0 && (clearInterval(countdownInterval), unlockForm());
      }, 50);
    }

    function unlockForm() {
      isLocked = !1,
      failedAttempts = 0,
      localStorage.removeItem('failedAttempts'),
      localStorage.removeItem('lockState'),
      document.getElementById('passwordGroup').style.display = 'flex',
      document.getElementById('submitButton').style.display = 'block',
      document.getElementById('waitMessage').style.display = 'none',
      document.getElementById('errorMessage').style.display = 'none';
    }

    function togglePasswordVisibility() {
      const e = document.getElementById('passwordInput'),
        t = document.querySelector('.eye-btn');
      e.type = 'password' === e.type ? 'text' : 'password',
      t.classList.toggle('active');
    }

    function logout() {
      localStorage.removeItem('userRole'),
      localStorage.removeItem('lockState'),
      localStorage.removeItem('failedAttempts'),
      location.reload();
    }

    function showWelcomeMessage() {
      const e = document.getElementById('welcomeMessage');
      e.classList.remove('hidden'),
      setTimeout(() => {
        e.classList.add('hidden');
      }, 3e3);
    }

    window.onload = function () {
      const e = localStorage.getItem('userRole'),
        t = JSON.parse(localStorage.getItem('lockState'));
      if (t && t.isLocked) {
        const e = Date.now() - t.lockTimestamp;
        e < 3e4 ? (
          isLocked = !0,
          document.getElementById('passwordGroup').style.display = 'none',
          document.getElementById('submitButton').style.display = 'none',
          document.getElementById('errorMessage').style.display = 'none',
          startCountdown(t.lockTimestamp)
        ) : unlockForm();
      }
      failedAttempts > 0 && !isLocked && (
        document.getElementById('errorMessage').textContent = `Incorrect password. ${3 - failedAttempts} attempts remaining.`,
        document.getElementById('errorMessage').style.display = 'block'
      ),
      e && (
        document.getElementById('passwordForm').style.display = 'none',
        document.querySelectorAll('.commonContent').forEach(e => e.style.display = 'block'),
        'user' === e ? document.querySelectorAll('.userContent').forEach(e => e.style.display = 'block') : 'admin' === e && document.querySelectorAll('.adminContent').forEach(e => e.style.display = 'block')
      );
    };

    /* Preloader Loader animation */
    const loader = document.getElementById('loader'),
      content = document.getElementById('protected-content');
    window.addEventListener("load", () => {
      loader.classList.add('hidden');
      setTimeout(() => {
        loader.style.display = 'none';
        content.style.display = 'block';
      }, loaderDuration);
    });

    /* Function to show and hide the welcome message */
    function showWelcomeMessage() {
      const welcomeDivs = document.querySelectorAll('.welcome');
      /* Show all welcome messages */
      welcomeDivs.forEach(div => {
        div.classList.remove('hidden');
      });
      /* Wait for 3 seconds, then fade out all welcome messages */
      setTimeout(() => {
        welcomeDivs.forEach(div => {
          div.classList.add('hidden');
        });
      }, 2000); /* 3000 milliseconds = 3 seconds */
    }

    /* Redirect to index page whenever log in */
    function redirectToPage() {
      window.location.href = './../../../index.html';
    }

    /* Progress bar */
    document.addEventListener('DOMContentLoaded', () => {
      const redirectAfter = 1000;
      const redirectUrl = "./../../../index.html";
      const showCountdown = true;
      const canvas = document.getElementById('progress-bar');
      const ctx = canvas.getContext('2d');
      canvas.width = window.innerWidth;
      canvas.height = 4;
      if (!localStorage.getItem('countdown')) {
        localStorage.setItem('countdown', redirectAfter);
      }
      let timer = parseInt(localStorage.getItem('countdown'), 10);
      function setProgress(value) {
        const percentage = (value / redirectAfter) * 100;
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        ctx.fillStyle = '#4caf50';
        ctx.fillRect(0, 0, (percentage / 100) * canvas.width, canvas.height);
      }
      if (!showCountdown) {
        canvas.style.display = 'none';
      }
      const interval = setInterval(() => {
        timer--;
        if (showCountdown) {
          setProgress(timer);
        }
        localStorage.setItem('countdown', timer);
        if (timer <= 0) {
          clearInterval(interval);
          localStorage.removeItem('countdown');
          window.location.href = redirectUrl;
        }
      }, 1000);
      window.addEventListener('beforeunload', () => {
        localStorage.removeItem('countdown');
      });
    });

    /* Fix for navigation links */
    document.querySelectorAll(".toppanel a").forEach(link => {
      link.addEventListener("click", function (event) {
        if (this.getAttribute("href") === "#" || this.getAttribute("href") === "javascript:void(0)") {
          event.preventDefault(); // Prevent default behavior only for these cases
          this.classList.toggle("visited");
        }
        // Allow default behavior for other links (navigation)
      });
    });
	

  </script>
</body>
</html>
